<div class="relative bg-black min-h-[120px]">
  <!-- ðŸ”Ž Barra de bÃºsqueda -->
  <div class="bg-black shadow-md border-b border-gray-700 sticky top-0 z-50 p-4">
    <div class="max-w-6xl mx-auto">
      <form [formGroup]="searchProductForm" class="flex gap-3 items-center">

        <!-- Campo de texto -->
        <div class="flex-1 relative">
          <input
            type="text"
            formControlName="q"
            placeholder="ðŸ”Ž Buscar productos..."
            class="w-full px-5 py-3 bg-gray-800 text-gray-200 border border-gray-700 
                   rounded-xl shadow-sm placeholder-gray-500
                   focus:ring-2 focus:ring-orange-500 focus:border-orange-500
                   transition-all duration-200 text-base"
          />
        </div>

        <!-- Filtros -->
        <div class="flex gap-2 items-center">
          <span class="text-sm text-gray-400 hidden md:block font-medium">Precio</span>

          <input
            type="number"
            formControlName="minPrice"
            placeholder="Min"
            class="w-24 px-3 py-3 bg-gray-800 text-gray-200 border border-gray-700 
                   rounded-lg shadow-sm placeholder-gray-500
                   focus:ring-2 focus:ring-orange-500 transition text-sm"
          />

          <span class="text-gray-500 font-semibold">â€”</span>

          <input
            type="number"
            formControlName="maxPrice"
            placeholder="Max"
            class="w-24 px-3 py-3 bg-gray-800 text-gray-200 border border-gray-700 
                   rounded-lg shadow-sm placeholder-gray-500
                   focus:ring-2 focus:ring-orange-500 transition text-sm"
          />
        </div>

      </form>
    </div>
  </div>

  <!-- ðŸ“Œ Dropdown de sugerencias -->
  @if (searchProductForm.get('q')?.value && searchProductForm.get('q')?.value!.length > 0) {

    <div
      class="absolute top-full left-0 right-0 z-40 bg-gray-900 shadow-2xl border-t border-gray-700
             rounded-b-xl max-w-6xl mx-auto animate-fadeIn"
    >
      <div class="p-4">
        @if (products$ | async; as products) {

          <div class="grid grid-cols-1 md:grid-cols-2 gap-2 max-h-72 overflow-y-auto">

            @for (product of products; track product._id) {
              <div
                class="flex items-center gap-3 p-3 hover:bg-gray-800 rounded-lg cursor-pointer 
                       transition-all duration-150"
              >
                <!-- Imagen -->
                <div class="w-14 h-14 bg-gray-700 rounded-md flex-shrink-0 shadow-sm"></div>

                <div class="flex-1 min-w-0">
                  <h4 class="text-sm font-medium text-gray-200 truncate">
                    {{ product.name }}
                  </h4>
                  <p class="text-sm text-gray-400">$ {{ product.price }}</p>
                </div>

                <a
                  [routerLink]="['/product-view', product._id]"
                  [queryParams]="{ q: searchProductForm.get('q')?.value }"
                  class="text-orange-400 text-sm font-semibold hover:text-orange-500 
                         hover:underline transition ml-auto"
                >
                  Ver
                </a>
              </div>
            }

            @empty {
              <div class="text-center py-4 text-gray-400 font-medium">
                No se encontraron productos
              </div>
            }

          </div>

        }
      </div>
    </div>
  }
</div>
