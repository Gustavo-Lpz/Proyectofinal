import{a as Ot}from"./chunk-BOH52QST.js";import{a as Dt}from"./chunk-7LR4MIEU.js";import{a as me,b as oe,c as ne,d as W,e as fe,f as ie,g as re,h as he,i as ge,j as se,k as ee,l as ve,m as Ce}from"./chunk-S6GGOMMJ.js";import{a as lt,c as ht,d as ue,e as de,f as gt}from"./chunk-PZXQOTNQ.js";import{a as $t}from"./chunk-X3M3N6ZJ.js";import{a as $e,b as wt,c as Et,d as St,g as X}from"./chunk-RFCIZRZT.js";import{b as It,e as kt,f as At,g as Tt,i as pe,j as Ft,k as Mt,l as Rt,r as Pt}from"./chunk-6SI6O3BZ.js";import{a as vt,c as Ct,d as xt,e as bt,f as w,i as _t,j as y,k as yt}from"./chunk-5LHHFRH4.js";import{f as le,g as at,h as ct,j as Y,n as Q}from"./chunk-FTR46PKS.js";import{$b as S,Ab as nt,B as Re,C as K,Cb as g,Db as it,E as T,Ec as ut,Fb as V,G as Be,Gb as L,Gc as dt,Ha as et,Hb as i,Hc as pt,I as P,Ib as s,Ic as mt,J as Ge,Jb as c,Jc as ft,K as qe,Kb as U,L as Ke,M as Ze,Ob as x,P as Pe,Pb as h,S as Je,V as Ye,Xa as tt,Z as D,Za as a,Zb as l,_b as rt,a as m,aa as O,b as v,cb as H,dc as De,ea as Z,ec as Oe,fc as z,gc as B,h as ae,ha as $,ib as C,ja as J,k as ze,ka as f,lc as st,nb as p,oa as Qe,pa as Xe,r as F,s as ce,ua as We,v as _,va as j,wa as N,x as Me,xa as E,ya as te,yb as d,zb as ot}from"./chunk-LZBM4COA.js";function Wt(e,o){e&1&&(i(0,"div",5),c(1,"div",7),s())}function eo(e,o){if(e&1&&c(0,"img",6),e&2){let t=h().$implicit;d("src",t.src,tt)("alt",t.alt)}}function to(e,o){e&1&&c(0,"div",5)}function oo(e,o){if(e&1&&(i(0,"div",4),p(1,Wt,2,0,"div",5)(2,eo,1,2,"img",6)(3,to,1,0,"div",5),s()),e&2){let t=o.$implicit,n=o.$index,r=h();ot("opacity-100",n===r.currentIndex)("opacity-0",n!==r.currentIndex),a(),g(t.loading?1:-1),a(),g(t.loaded?2:-1),a(),g(!t.loaded&&!t.loading?3:-1)}}function no(e,o){if(e&1){let t=U();i(0,"button",8),x("click",function(){j(t);let r=h();return N(r.prevImage())}),E(),i(1,"svg",9),c(2,"path",10),s()(),te(),i(3,"button",11),x("click",function(){j(t);let r=h();return N(r.nextImage())}),E(),i(4,"svg",9),c(5,"path",12),s()()}}var xe=class e{images=[{src:"images/grand.jpg",loaded:!1,loading:!1,alt:""},{src:"images/REQ.webp",loaded:!1,loading:!1,alt:""},{src:"images/pragmata.webp",loaded:!1,loading:!1,alt:""},{src:"images/Tidesss.jpg",loaded:!1,loading:!1,alt:""},{src:"images/Gears.jpg",loaded:!1,loading:!1,alt:""}];autoPlay=!0;showIndicators=!0;showControls=!0;interval=7e3;currentIndex=0;isDestroyed=!1;autoPlayInterval;ngOnInit(){this.loadImage(0),this.autoPlay&&this.startAutoPlay()}ngOnChanges(o){console.log("cambios en la configuracion del carousel",o),o.images&&!o.images.firstChange&&(this.currentIndex=0,this.resetLoadedStates(),this.loadImage(this.currentIndex)),o.autoPlay&&!o.autoPlay.firstChange&&(o.autoPlay.currentValue?this.startAutoPlay():this.stopAutoPlay()),o.interval&&!o.interval.firstChange&&this.autoPlay&&(this.stopAutoPlay(),this.startAutoPlay())}ngOnDestroy(){console.log("Componente destruido"),this.isDestroyed=!0,this.stopAutoPlay(),this.cancelPendingImagesLoads()}loadImage(o){if(o<0||o>=this.images.length||this.images[o].loaded)return;this.images[o].loading=!0;let t=new Image;t.onload=()=>{console.log(`Imagen ${o+1} cargada exitosamente`),setTimeout(()=>{this.images[o].loaded=!0,this.images[o].loading=!1},1e3)},t.src=this.images[o].src}startAutoPlay(){this.autoPlay&&!this.isDestroyed&&(this.autoPlayInterval=window.setInterval(()=>{console.log(this.currentIndex),this.nextImage()},this.interval))}stopAutoPlay(){this.autoPlayInterval&&(clearInterval(this.autoPlayInterval),this.autoPlayInterval=void 0)}nextImage(){this.currentIndex=(this.currentIndex+1)%this.images.length,this.loadImage(this.currentIndex);let o=(this.currentIndex+1)%this.images.length;this.loadImage(o)}prevImage(){this.currentIndex=this.currentIndex===0?this.images.length-1:this.currentIndex-1,this.loadImage(this.currentIndex);let o=this.currentIndex===0?this.images.length-1:this.currentIndex-1;this.loadImage(o)}resetLoadedStates(){this.images.forEach(o=>{o.loaded=!1,o.loading=!1})}cancelPendingImagesLoads(){this.images.forEach(o=>{o.loading=!1})}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=C({type:e,selectors:[["app-carousel"]],inputs:{images:"images",autoPlay:"autoPlay",showIndicators:"showIndicators",showControls:"showControls",interval:"interval"},features:[We],decls:7,vars:1,consts:[[2,"font-size","2.2rem","text-align","center","font-weight","bold","color","red","border-bottom","3px solid #4CAF50","display","inline-block","padding-bottom","5px","margin","20px auto"],[1,"relative","w-full","max-w-6xl","mx-auto","bg-white","rounded-lg","overflow-hidden","shadow-md","hover:shadow-lg","transition-shadow","duration-300","mb-8"],[1,"relative","h-64","md:h-80","lg:h-96","overflow-hidden"],[1,"absolute","inset-0","transition-opacity","duration-500","ease-in-out",3,"opacity-100","opacity-0"],[1,"absolute","inset-0","transition-opacity","duration-500","ease-in-out"],[1,"w-full","h-full","bg-gray-100","flex","items-center","justify-center"],[1,"w-full","h-full","object-cover",3,"src","alt"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-blue-600"],[1,"absolute","top-1/2","left-4","transform","-translate-y-1/2","bg-white/80","hover:bg-white","text-gray-700","rounded-full","shadow-md","transition-all","duration-200","hover:scale-110",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"absolute","top-1/2","right-4","transform","-translate-y-1/2","bg-white/80","hover:bg-white","text-gray-700","rounded-full","shadow-md","transition-all","duration-200","hover:scale-110",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"]],template:function(t,n){t&1&&(i(0,"h2",0),l(1,` Los m\xE1s Esperados 2026
`),s(),i(2,"div",1)(3,"div",2),V(4,oo,4,7,"div",3,it),p(6,no,6,0),s()()),t&2&&(a(4),L(n.images),a(2),g(n.showControls?6:-1))},encapsulation:2})};function io(e,o){e&1&&(E(),i(0,"svg",3),c(1,"path",6),s())}function ro(e,o){e&1&&(E(),i(0,"svg",4),c(1,"path",7)(2,"path",8),s())}function so(e,o){e&1&&(E(),i(0,"svg",3),c(1,"path",9),s())}function ao(e,o){e&1&&(E(),i(0,"svg",3),c(1,"path",10),s())}var be=class e{indicators=!1;autoPlay=!0;title="";constructor(){this.title$.pipe(_(o=>o.toDateString())).subscribe(this.setTitle)}setTitle=()=>{let o=new Date;this.title=`(${o})`};title$=new ae(o=>{setInterval(()=>{o.next(new Date)},2e3)});static \u0275fac=function(t){return new(t||e)};static \u0275cmp=C({type:e,selectors:[["app-home"]],decls:8,vars:6,consts:[[1,"relative","w-full","max-w-6xl","mx-auto"],[3,"autoPlay","interval","showIndicators","showControls"],[1,"absolute","bottom-6","right-12","z-20","bg-white/90","hover:bg-white","text-gray-700","hover:text-gray-900","p-2","rounded-full","shadow-lg","transition-all","duration-200","hover:scale-110",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"h-4","w-4"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"w-4","h-4"],[1,"absolute","bottom-6","right-0","z-20","bg-white/90","hover:bg-white","text-gray-700","hover:text-gray-900","p-2","rounded-full","shadow-lg","transition-all","duration-200","hover:scale-110",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"],["stroke-linecap","round","stroke-linejoin","round","d","M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"],["stroke-linecap","round","stroke-linejoin","round","d","M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"],["stroke-linecap","round","stroke-linejoin","round","d","M15.75 5.25v13.5m-7.5-13.5v13.5"],["stroke-linecap","round","stroke-linejoin","round","d","M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"]],template:function(t,n){t&1&&(i(0,"div",0),c(1,"app-carousel",1),i(2,"button",2),x("click",function(){return n.indicators=!n.indicators}),p(3,io,2,0,":svg:svg",3)(4,ro,3,0,":svg:svg",4),s(),i(5,"button",5),x("click",function(){return n.autoPlay=!n.autoPlay}),p(6,so,2,0,":svg:svg",3)(7,ao,2,0,":svg:svg",3),s()()),t&2&&(a(),d("autoPlay",n.autoPlay)("interval",3e3)("showIndicators",n.indicators)("showControls",n.indicators),a(2),g(n.indicators?3:4),a(3),g(n.autoPlay?6:7))},dependencies:[xe],encapsulation:2})};var je=(e,o)=>{let t=f(ue),n=f(w),r=!1;return n.select(St).pipe(P(1)).subscribe({next:u=>{r=u}}),r?!0:(t.navigateByUrl("/login"),!1)};var jt=(e,o,t,n)=>e.canDeactivate?e.canDeactivate():!0;var Nt=[{path:"",component:be,title:"Home"},{path:"products",loadComponent:()=>import("./chunk-7LLUUMFW.js").then(e=>e.ProductsComponent),title:"products"},{path:"product-view/:id",loadComponent:()=>import("./chunk-62R32CYB.js").then(e=>e.ProductDetailComponent),title:"product details"},{path:"register",loadComponent:()=>import("./chunk-M3V7U5FL.js").then(e=>e.RegisterComponent),title:"registro"},{path:"login",loadComponent:()=>import("./chunk-PFRS5V3L.js").then(e=>e.LoginComponent),title:"login",canDeactivate:[jt]},{path:"user",loadComponent:()=>import("./chunk-FEANPBU3.js").then(e=>e.UserComponent),loadChildren:()=>import("./chunk-TW2YYWHY.js").then(e=>e.USER_ROUTES),canActivate:[je]},{path:"thank-you-page",loadComponent:()=>import("./chunk-2X75C2YB.js").then(e=>e.ThankYouComponent)},{path:"checkout",loadComponent:()=>import("./chunk-VG5UF6OX.js").then(e=>e.CheckOutComponent),canActivate:[je],title:"Checkout"}];var Ht=(e,o)=>{let t=f(w),n="";t.select($e).pipe(P(1)).subscribe(b=>n=b??""),console.log(n);let r=new ut({"Content-Type":"application/json",Authorization:`Bearer ${n}`}),u=e.clone({headers:r});return o(u).pipe(T(b=>{if(console.log(b),b.status===403&&b.error.message==="Forbidden"){let A="";return t.select(wt).pipe(P(1)).subscribe(R=>{A=R??""}),t.dispatch(he({refreshToken:A})),t.select($e).pipe(K(R=>R!==n&&R!==null),P(1),D(R=>{let Fe=e.clone({setHeaders:{Authorization:`Bearer ${R}`}});return o(Fe)}))}return ce(()=>b)}))};var Vt=(e,o)=>{let t=f(X);return o(e).pipe(T(n=>{let r=co(n);return t.error(r,3e3),ce(()=>n)}))},co=e=>{if(e.status===0)return"No hay conexion a internet";if(e.error?.message)return e.error.message;switch(e.status){case 400:return"Datos invalidos, verifica la infomraci\xF3n";case 401:return"Sesi\xF3n expirada. Por favor inicie sesi\xF3n nuevamente";case 403:return"No tienes permisos para realizar esta acci\xF3n";case 404:return"Recurso no encontrado";case 409:return"El recurso ya existe o hay un conflicto";case 422:return"Error de validaci\xF3n";case 500:return"Error del servidor";case 503:return"Servicio no disponible. Intente m\xE1s tarde.";default:return`Error inesperado (${e.status}). Intente nuevamente`}};var lo={dispatch:!0,functional:!1,useEffectsErrorHandler:!0},_e="__@ngrx/effects_create__";function I(e,o={}){let t=o.functional?e:e(),n=m(m({},lo),o);return Object.defineProperty(t,_e,{value:n}),t}function uo(e){return Object.getOwnPropertyNames(e).filter(n=>e[n]&&e[n].hasOwnProperty(_e)?e[n][_e].hasOwnProperty("dispatch"):!1).map(n=>{let r=e[n][_e];return m({propertyName:n},r)})}function po(e){return uo(e)}function Ut(e){return Object.getPrototypeOf(e)}function mo(e){return!!e.constructor&&e.constructor.name!=="Object"&&e.constructor.name!=="Function"}function zt(e){return typeof e=="function"}function fo(e){return e.filter(zt)}function ho(e,o,t){let n=Ut(e),u=!!n&&n.constructor.name!=="Object"?n.constructor.name:null,b=po(e).map(({propertyName:A,dispatch:R,useEffectsErrorHandler:Fe})=>{let Le=typeof e[A]=="function"?e[A]():e[A],Ue=Fe?t(Le,o):Le;return R===!1?Ue.pipe(Ge()):Ue.pipe(Je()).pipe(_(Xt=>({effect:e[A],notification:Xt,propertyName:A,sourceName:u,sourceInstance:e})))});return Re(...b)}var go=10;function Bt(e,o,t=go){return e.pipe(T(n=>(o&&o.handleError(n),t<=1?e:Bt(e,o,t-1))))}var Gt=(()=>{class e extends ae{constructor(t){super(),t&&(this.source=t)}lift(t){let n=new e;return n.source=this,n.operator=t,n}static{this.\u0275fac=function(n){return new(n||e)(J(bt))}}static{this.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function k(...e){return K(o=>e.some(t=>typeof t=="string"?t===o.type:t.type===o.type))}var Kn=new $("@ngrx/effects Internal Root Guard"),Zn=new $("@ngrx/effects User Provided Effects"),Jn=new $("@ngrx/effects Internal Root Effects"),Yn=new $("@ngrx/effects Internal Root Effects Instances"),Qn=new $("@ngrx/effects Internal Feature Effects"),Xn=new $("@ngrx/effects Internal Feature Effects Instance Groups"),vo=new $("@ngrx/effects Effects Error Handler",{providedIn:"root",factory:()=>Bt}),Co="@ngrx/effects/init",xo=vt(Co);function bo(e,o){if(e.notification.kind==="N"){let t=e.notification.value;!_o(t)&&o.handleError(new Error(`Effect ${yo(e)} dispatched an invalid action: ${wo(t)}`))}}function _o(e){return typeof e!="function"&&e&&e.type&&typeof e.type=="string"}function yo({propertyName:e,sourceInstance:o,sourceName:t}){let n=typeof o[e]=="function";return!!t?`"${t}.${String(e)}${n?"()":""}"`:`"${String(e)}()"`}function wo(e){try{return JSON.stringify(e)}catch{return e}}var Eo="ngrxOnIdentifyEffects";function So(e){return He(e,Eo)}var Io="ngrxOnRunEffects";function ko(e){return He(e,Io)}var Ao="ngrxOnInitEffects";function To(e){return He(e,Ao)}function He(e,o){return e&&o in e&&typeof e[o]=="function"}var qt=(()=>{class e extends ze{constructor(t,n){super(),this.errorHandler=t,this.effectsErrorHandler=n}addEffects(t){this.next(t)}toActions(){return this.pipe(Pe(t=>mo(t)?Ut(t):t),Me(t=>t.pipe(Pe(Fo))),Me(t=>{let n=t.pipe(Ze(u=>Mo(this.errorHandler,this.effectsErrorHandler)(u)),_(u=>(bo(u,this.errorHandler),u.notification)),K(u=>u.kind==="N"&&u.value!=null),qe()),r=t.pipe(P(1),K(To),_(u=>u.ngrxOnInitEffects()));return Re(n,r)}))}static{this.\u0275fac=function(n){return new(n||e)(J(et),J(vo))}}static{this.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function Fo(e){return So(e)?e.ngrxOnIdentifyEffects():""}function Mo(e,o){return t=>{let n=ho(t,e,o);return ko(t)?t.ngrxOnRunEffects(n):n}}var Ro=(()=>{class e{get isStarted(){return!!this.effectsSubscription}constructor(t,n){this.effectSources=t,this.store=n,this.effectsSubscription=null}start(){this.effectsSubscription||(this.effectsSubscription=this.effectSources.toActions().subscribe(this.store))}ngOnDestroy(){this.effectsSubscription&&(this.effectsSubscription.unsubscribe(),this.effectsSubscription=null)}static{this.\u0275fac=function(n){return new(n||e)(J(qt),J(w))}}static{this.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function Kt(...e){let o=e.flat(),t=fo(o);return Qe([t,Xe(()=>{f(Ct),f(xt,{optional:!0});let n=f(Ro),r=f(qt),u=!n.isStarted;u&&n.start();for(let b of o){let A=zt(b)?f(b):b;r.addEffects(A)}u&&f(w).dispatch(xo())})])}var Ve={token:localStorage.getItem("token"),refreshToken:localStorage.getItem("refreshToken"),decodedToken:null,isAuthenticated:!1,isLoading:!1,error:null};var Zt=yt(Ve,y(ee,e=>v(m({},e),{isLoading:!0})),y(ve,(e,{decodedToken:o})=>v(m({},e),{decodedToken:o,isAuthenticated:!0,isLoading:!1})),y(Ce,e=>v(m({},e),{token:null,refreshToken:null,decodedToken:null,isAuthenticated:!1,isLoading:!1})),y(me,e=>v(m({},e),{isLoading:!0,error:null})),y(oe,(e,{token:o,refreshToken:t,decodedToken:n})=>v(m({},e),{token:o,refreshToken:t,decodedToken:n,isAuthenticated:!0,isLoading:!1,error:null})),y(ne,(e,{error:o})=>v(m({},e),{isLoading:!1,error:o,isAuthenticated:!1})),y(fe,e=>v(m({},e),{isLoading:!0,error:null})),y(ie,e=>v(m({},e),{isLoading:!1,error:null})),y(re,(e,{error:o})=>v(m({},e),{isLoading:!1,error:o})),y(ge,(e,{token:o,decodedToken:t})=>v(m({},e),{token:o,decodedToken:t,isAuthenticated:!0,isLoading:!1,error:null})),y(se,(e,{error:o})=>v(m({},e),{token:null,refreshToken:null,decodedToken:null,isAuthenticated:!1,isLoading:!1,error:o})),y(W,()=>v(m({},Ve),{token:null,refreshToken:null,decodedToken:null,isAuthenticated:!1})));var q=class extends Error{};q.prototype.name="InvalidTokenError";function Po(e){return decodeURIComponent(atob(e).replace(/(.)/g,(o,t)=>{let n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function Do(e){let o=e.replace(/-/g,"+").replace(/_/g,"/");switch(o.length%4){case 0:break;case 2:o+="==";break;case 3:o+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return Po(o)}catch{return atob(o)}}function ye(e,o){if(typeof e!="string")throw new q("Invalid token specified: must be a string");o||(o={});let t=o.header===!0?0:1,n=e.split(".")[t];if(typeof n!="string")throw new q(`Invalid token specified: missing part #${t+1}`);let r;try{r=Do(n)}catch(u){throw new q(`Invalid token specified: invalid base64 for part #${t+1} (${u.message})`)}try{return JSON.parse(r)}catch(u){throw new q(`Invalid token specified: invalid json for part #${t+1} (${u.message})`)}}var we=class e{actions$=f(Gt);http=f(dt);router=f(ue);toast=f(X);baseUrl=`${$t.BACK_URL}/auth`;initializeAuth$=I(()=>this.actions$.pipe(k(ee),_(()=>{let o=localStorage.getItem("token");if(!o)return Ce();let t=ye(o);return console.log(t),ve({decodedToken:t})})));login$=I(()=>this.actions$.pipe(k(me),O(o=>console.log(o)),D(({credentials:o})=>this.http.post(`${this.baseUrl}/login`,o).pipe(_(t=>{localStorage.setItem("token",t.token),localStorage.setItem("refreshToken",t.refreshToken);let n=ye(t.token);return oe({token:t.token,refreshToken:t.refreshToken,decodedToken:n})}),T(t=>(console.error("Error en login:",t),F(ne({error:t.error?.message||"Error al iniciar sesi\xF3n"}))))))));loginSuccess$=I(()=>this.actions$.pipe(k(oe),O(()=>{this.toast.success("Inicio de sesi\xF3n exitoso"),this.router.navigate(["/"])})),{dispatch:!1});loginFailure$=I(()=>this.actions$.pipe(k(ne),O(({error:o})=>{this.toast.error(o)})),{dispatch:!1});register$=I(()=>this.actions$.pipe(k(fe),D(({userData:o})=>this.http.post(`${this.baseUrl}/register`,o).pipe(_(()=>ie()),T(t=>(console.error("Error en registro:",t),F(re({error:t.error?.message||"Error al registrarse"}))))))));registerSuccess$=I(()=>this.actions$.pipe(k(ie),O(()=>{this.toast.success("Registro exitoso. Por favor inicia sesi\xF3n."),this.router.navigate(["/auth/login"])})),{dispatch:!1});registerFailure$=I(()=>this.actions$.pipe(k(re),O(({error:o})=>{this.toast.error(o)})),{dispatch:!1});logout$=I(()=>this.actions$.pipe(k(W),O(()=>{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),this.toast.success("Sesi\xF3n cerrada correctamente"),this.router.navigate(["/"])})),{dispatch:!1});refreshToken$=I(()=>this.actions$.pipe(k(he),D(({refreshToken:o})=>this.http.post(`${this.baseUrl}/refresh-token`,{token:o}).pipe(_(t=>{localStorage.setItem("token",t.token);let n=ye(t.token);return ge({token:t.token,decodedToken:n})}),T(t=>(console.error("Error al refrescar token:",t),localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),F(se({error:"Sesi\xF3n expirada"}))))))));refreshTokenFailure$=I(()=>this.actions$.pipe(k(se),O(()=>{this.toast.error("Sesi\xF3n expirada. Por favor inicia sesi\xF3n nuevamente."),this.router.navigate(["/auth/login"])})),{dispatch:!1});static \u0275fac=function(t){return new(t||e)};static \u0275prov=Z({token:e,factory:e.\u0275fac})};var Jt={providers:[st({eventCoalescing:!0}),gt(Nt),pt(ft(),mt([Ht,Vt])),_t({auth:Zt}),Kt([we])]};var Oo=e=>["/product-view",e],$o=e=>({q:e}),jo=(e,o)=>o._id;function No(e,o){if(e&1){let t=U();i(0,"div",11),c(1,"div",13),i(2,"div",14)(3,"h4",15),l(4),s(),i(5,"p",16),l(6),s()(),i(7,"a",17),x("click",function(){j(t);let r=h(3);return N(r.goToProduct())}),l(8," Ver Detalles "),s()()}if(e&2){let t,n=o.$implicit,r=h(3);a(4),S(" ",n.name," "),a(2),S("$ ",n.price,""),a(),d("routerLink",De(4,Oo,n._id))("queryParams",De(6,$o,(t=r.searchProductForm.get("q"))==null?null:t.value))}}function Ho(e,o){e&1&&(i(0,"div",12),l(1," No se encontraron productos "),s())}function Vo(e,o){e&1&&(i(0,"div",10),V(1,No,9,8,"div",11,jo,!1,Ho,2,0,"div",12),s()),e&2&&(a(),L(o))}function Lo(e,o){if(e&1&&(i(0,"div",8)(1,"div",9),p(2,Vo,4,1,"div",10),z(3,"async"),s()()),e&2){let t,n=h();a(2),g((t=B(3,1,n.products$))?2:-1,t)}}var Ee=class e{constructor(o){this.productService=o}searchProductForm=new Tt({q:new pe("",{nonNullable:!0}),minPrice:new pe(0,{nonNullable:!0}),maxPrice:new pe(1e3,{nonNullable:!0})});searchConfig$=this.searchProductForm.valueChanges.pipe(Be(300),Ke((o,t)=>o===t),_(o=>{let t=v(m({},o),{q:o.q?.trim()||""});return localStorage.setItem("searchConfig",JSON.stringify(t)),t}));products$=this.searchConfig$.pipe(D(o=>this.productService.searchProducts(o)));results;searchTerm;ngOnInit(){this.searchConfig$.subscribe({next:o=>console.log(o)})}goToProduct(){this.searchProductForm.get("q")?.setValue("")}static \u0275fac=function(t){return new(t||e)(H(Dt))};static \u0275cmp=C({type:e,selectors:[["app-search-products"]],decls:10,vars:2,consts:[[1,"relative","bg-red-600","min-h-[110px]"],[1,"bg-gray-600","shadow-md","border-b","border-gray-700","sticky","top-0","z-50","p-4"],[1,"max-w-6xl","mx-auto"],[1,"flex","items-center","justify-between","w-full",3,"formGroup"],[1,"text-white","text-xl","font-bold","tracking-wide"],[1,"flex-1","flex","justify-center"],["type","text","formControlName","q","placeholder","\u{1F50E} Buscar productos...",1,"w-[60%]","px-5","py-3","bg-gray-800","text-gray-200","border","border-gray-700","rounded-xl","shadow-sm","placeholder-gray-500","focus:ring-2","focus:ring-orange-500","focus:border-orange-500","transition-all","duration-200","text-base"],[1,"w-[120px]"],[1,"absolute","top-full","left-0","right-0","z-40","bg-gray-900","shadow-2xl","border-t","border-gray-700","rounded-b-xl","max-w-6xl","mx-auto","animate-fadeIn"],[1,"p-4"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-2","max-h-72","overflow-y-auto"],[1,"flex","items-center","gap-3","p-3","hover:bg-gray-800","rounded-lg","cursor-pointer","transition-all","duration-150"],[1,"text-center","py-4","text-gray-400","font-medium"],[1,"w-14","h-14","bg-gray-700","rounded-md","flex-shrink-0","shadow-sm"],[1,"flex-1","min-w-0"],[1,"text-sm","font-medium","text-gray-200","truncate"],[1,"text-sm","text-gray-400"],[1,"text-orange-400","text-sm","font-semibold","hover:text-orange-500","hover:underline","transition","ml-auto",3,"click","routerLink","queryParams"]],template:function(t,n){if(t&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"form",3)(4,"h2",4),l(5," GameSearch "),s(),i(6,"div",5),c(7,"input",6),s(),c(8,"div",7),s()()(),p(9,Lo,4,3,"div",8),s()),t&2){let r;a(3),d("formGroup",n.searchProductForm),a(6),g((r=n.searchProductForm.get("q"))!=null&&r.value&&((r=n.searchProductForm.get("q"))==null?null:r.value.length)>0?9:-1)}},dependencies:[Pt,Ft,It,kt,At,Mt,Rt,Y,de],encapsulation:2})};var Se=class e{route;static \u0275fac=function(t){return new(t||e)};static \u0275cmp=C({type:e,selectors:[["app-menu-item"]],inputs:{route:"route"},decls:3,vars:3,consts:[[1,"flex","items-center","px-4","py-3","rounded-lg","transition-all","duration-200","cursor-pointer","hover:bg-slate-700","hover:text-red-500","group",3,"routerLink","ngClass"],[1,"text-base","font-medium","group-hover:tracking-wide","transition-all","duration-200"]],template:function(t,n){t&1&&(i(0,"a",0)(1,"span",1),l(2),s()()),t&2&&(d("routerLink",n.route.route)("ngClass",n.route.textColor||"text-white"),a(2),S(" ",n.route.title," "))},dependencies:[de,Q,le],encapsulation:2})};function Uo(e,o){if(e&1&&(i(0,"h3",4),l(1),s()),e&2){let t=h();a(),S(" ",t.title," ")}}function zo(e,o){if(e&1&&c(0,"app-menu-item",5),e&2){let t=o.$implicit;d("route",t)}}var Ie=class e{title;navRoutes=[];static \u0275fac=function(t){return new(t||e)};static \u0275cmp=C({type:e,selectors:[["app-side-menu"]],inputs:{title:"title",navRoutes:"navRoutes"},decls:4,vars:2,consts:[[1,"mt-6"],["class",`pt-4 text-xs font-semibold text-red-400 uppercase tracking-widest mb-3
           border-b border-red-700 pb-2
           drop-shadow-[0_0_4px_rgba(255,0,0,0.4)]`,4,"ngIf"],[1,"space-y-2"],[3,"route",4,"ngFor","ngForOf"],[1,"pt-4","text-xs","font-semibold","text-red-400","uppercase","tracking-widest","mb-3","border-b","border-red-700","pb-2","drop-shadow-[0_0_4px_rgba(255,0,0,0.4)]"],[3,"route"]],template:function(t,n){t&1&&(i(0,"div",0),p(1,Uo,2,1,"h3",1),i(2,"nav",2),p(3,zo,1,1,"app-menu-item",3),s()()),t&2&&(a(),d("ngIf",n.title),a(2),d("ngForOf",n.navRoutes))},dependencies:[Q,at,ct,Se],encapsulation:2})};function Bo(e,o){if(e&1){let t=U();i(0,"div",15),x("click",function(){j(t);let r=h();return N(r.sideBarOpen=!1)}),s()}}function Go(e,o){if(e&1){let t=U();c(0,"app-side-menu",16),i(1,"button",17),x("click",function(){j(t);let r=h();return N(r.logout())}),l(2,` Cerrar sesi\xF3n
`),s()}if(e&2){let t=h();d("title",`Bienvenido ${o.displayName}`)("navRoutes",t.authRoutes)}}function qo(e,o){if(e&1&&c(0,"app-side-menu",12),e&2){let t=h();d("navRoutes",t.notAuthRoutes)}}function Ko(e,o){if(e&1&&c(0,"app-side-menu",18),e&2){let t=h();d("navRoutes",t.adminRoutes)}}var ke=class e{constructor(o){this.store=o}sideBarOpen=!1;routes=[{title:"Inicio",route:"",textColor:"text-green-200"},{title:"Productos",route:"/products",textColor:"text-green-200"},{title:"Categorias",route:"/categories",textColor:"text-green-200"}];adminRoutes=[{title:"Productos",route:"/admin/products"},{title:"Usuarios",route:"/admin/users"},{title:"Categorias",route:"/admin/categories"},{title:"Compras",route:"/admin/purchases"}];authRoutes=[{title:"Mi Perfil",route:"/user",textColor:"text-blue-500"},{title:"Mi Carrito",route:"/user/cart",textColor:"text-blue-500"},{title:"Direcciones de envio",route:"/user/shipping_address",textColor:"text-blue-500"},{title:"Metodos de pago",route:"/user/paymentmethods",textColor:"text-blue-500"},{title:"Lista de deseos",route:"/user/wishlist",textColor:"text-blue-500"}];notAuthRoutes=[{title:"Iniciar Sesion",route:"/login",textColor:"text-blue-500"},{title:"Registro",route:"/register",textColor:"text-blue-500"}];user$=F(null);ngOnInit(){this.user$=this.store.select(Et)}logout(){this.store.dispatch(W())}static \u0275fac=function(t){return new(t||e)(H(w))};static \u0275cmp=C({type:e,selectors:[["app-aside"]],decls:18,vars:7,consts:[[1,"relative","z-[100]"],[1,"fixed","top-4","right-4","p-3","bg-blue-600","z-50","text-white","rounded-full","shadow-lg","transition-all","duration-300","hover:bg-blue-700","hover:scale-110","hover:shadow-xl",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","d","M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"],[1,"fixed","inset-0","bg-black/60","z-40","transition-opacity","duration-300","backdrop-blur-sm"],[1,"fixed","inset-y-0","right-0","w-80","bg-slate-800","shadow-2xl","z-[100]","transform","transition-transform","duration-300","ease-in-out","flex","flex-col","border-l","border-slate-600"],[1,"flex","items-center","justify-between","p-4","border-b","border-slate-600","bg-slate-800"],[1,"text-xl","font-bold","text-red-500","uppercase","tracking-wide","border-b","border-red-700","pb-2","mb-4","drop-shadow-[0_0_6px_rgba(255,0,0,0.6)]"],[1,"p-2","rounded-full","hover:bg-slate-700","text-white","hover:text-gray-200","transition-colors","duration-200",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","d","M6 18 18 6M6 6l12 12"],[1,"flex-1","p-4","overflow-y-auto"],[3,"navRoutes"],["title","menu principal",3,"navRoutes"],["title","Administracion",3,"navRoutes",4,"appAdmin"],[1,"fixed","inset-0","bg-black/60","z-40","transition-opacity","duration-300","backdrop-blur-sm",3,"click"],[3,"title","navRoutes"],[1,"py-2","px-4","rounded-lg","w-3/5","mx-auto","mt-5","bg-red-700","text-white","font-semibold","tracking-wide","shadow-lg","shadow-red-900/40","border","border-red-800","transition-all","duration-300","hover:bg-red-600","hover:shadow-red-500/60","hover:scale-105","active:scale-95",3,"click"],["title","Administracion",3,"navRoutes"]],template:function(t,n){if(t&1&&(i(0,"div",0)(1,"button",1),x("click",function(){return n.sideBarOpen=!n.sideBarOpen}),E(),i(2,"svg",2),c(3,"path",3),s()(),p(4,Bo,1,0,"div",4),te(),i(5,"aside",5)(6,"div",6)(7,"h2",7),l(8,"Men\xFA"),s(),i(9,"button",8),x("click",function(){return n.sideBarOpen=!1}),E(),i(10,"svg",9),c(11,"path",10),s()()(),te(),i(12,"div",11),p(13,Go,3,2),z(14,"async"),p(15,qo,1,1,"app-side-menu",12),c(16,"app-side-menu",13),p(17,Ko,1,1,"app-side-menu",14),s()()()),t&2){let r;a(4),g(n.sideBarOpen?4:-1),a(),nt(n.sideBarOpen?"translate-x-0":"translate-x-full"),a(8),g((r=B(14,5,n.user$))?13:15,r),a(3),d("navRoutes",n.routes)}},dependencies:[Q,Y,Ie,Ot],encapsulation:2})};var Zo=(e,o)=>({"bg-green-600/30 text-green-100":e,"bg-red-600/30 text-red-100":o}),Jo=(e,o)=>({"bg-green-500/90":e,"bg-red-500/90":o}),Qt=(e,o)=>o.id;function Yo(e,o){if(e&1&&(i(0,"div",8)(1,"p",10),l(2),s(),i(3,"small",11),l(4),s()()),e&2){let t=o.$implicit;d("ngClass",Oe(3,Zo,t.type==="success",t.type==="error")),a(2),rt(t.text),a(2),S("ID: ",t.id,"")}}function Qo(e,o){e&1&&(i(0,"p",9),l(1," No hay notificaciones "),s())}function Xo(e,o){e&1&&(i(0,"div",7),V(1,Yo,5,6,"div",8,Qt,!1,Qo,2,0,"p",9),s()),e&2&&(a(),L(o))}function Wo(e,o){if(e&1&&(i(0,"div",3)(1,"div",4)(2,"h3",5),l(3,"\xDAltimas Notificaciones"),s(),i(4,"button",6),l(5," Limpiar "),s()(),p(6,Xo,4,1,"div",7),z(7,"async"),s()),e&2){let t,n=h();a(6),g((t=B(7,1,n.toastHistory$))?6:-1,t)}}function en(e,o){if(e&1&&(i(0,"div",12)(1,"div",13)(2,"p",14),l(3),s()()()),e&2){let t=o.$implicit;d("ngClass",Oe(2,Jo,t.type==="success",t.type==="error")),a(3),S(" ",t.text," ")}}function tn(e,o){e&1&&V(0,en,4,5,"div",12,Qt),e&2&&L(o)}var Ae=class e{constructor(o){this.toast=o}toasts$=F([]);toastHistory$=F([]);showHistory=!1;ngOnInit(){this.toasts$=this.toast.toast$,this.toastHistory$=this.toast.toastHistory$.pipe(Ye((o,t)=>[...o,t].slice(-10),[]))}toggleHistory(){this.showHistory=!this.showHistory}static \u0275fac=function(t){return new(t||e)(H(X))};static \u0275cmp=C({type:e,selectors:[["app-toast"]],decls:7,vars:5,consts:[[1,"fixed","top-24","right-4","z-20","space-y-3","w-80"],[1,"flex","justify-end","mb-2"],[1,"bg-gray-600/80","text-white","px-3","py-1","rounded-lg","text-sm","hover:bg-gray-700/80","transition-colors","backdrop-blur-sm",3,"click"],[1,"bg-gray-800/90","backdrop-blur-sm","rounded-xl","p-4","max-h-96","overflow-y-auto","border","border-gray-600"],[1,"flex","justify-between","items-center","mb-3"],[1,"text-white","font-medium","text-sm"],[1,"text-gray-400","hover:text-white","text-xs","underline"],[1,"space-y-2"],[1,"p-2","rounded","border","border-gray-600","text-xs",3,"ngClass"],[1,"text-gray-400","text-sm","text-center","py-4"],[1,"truncate"],[1,"text-gray-400"],[1,"toast-slide-in","rounded-xl","shadow-lg","backdrop-blur-sm","border","border-white/20","p-4","text-white","transform","transition-all","duration-300","hover:scale-[1.02]",3,"ngClass"],[1,"flex","items-center","justify-between"],[1,"font-medium","text-sm","leading-snug"]],template:function(t,n){if(t&1&&(i(0,"div",0)(1,"div",1)(2,"button",2),x("click",function(){return n.toggleHistory()}),l(3),s()(),p(4,Wo,8,3,"div",3)(5,tn,2,0),z(6,"async"),s()),t&2){let r;a(3),S(" ",n.showHistory?"Ocultar":"Historial"," "),a(),g(n.showHistory?4:-1),a(),g((r=B(6,3,n.toasts$))?5:-1,r)}},dependencies:[Y,le],encapsulation:2})};var Te=class e{constructor(o){this.store=o}title="ecommerce-app";ngOnInit(){this.store.dispatch(ee())}static \u0275fac=function(t){return new(t||e)(H(w))};static \u0275cmp=C({type:e,selectors:[["app-root"]],decls:4,vars:0,template:function(t,n){t&1&&c(0,"app-aside")(1,"app-search-products")(2,"app-toast")(3,"router-outlet")},dependencies:[ht,Ee,ke,Ae],encapsulation:2})};lt(Te,Jt).catch(e=>console.error(e));
