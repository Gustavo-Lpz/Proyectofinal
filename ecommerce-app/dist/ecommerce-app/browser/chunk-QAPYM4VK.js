import{a as Q,b as U}from"./chunk-SUQYPSBK.js";import"./chunk-U5YLW2ZZ.js";import"./chunk-X3M3N6ZJ.js";import"./chunk-RFCIZRZT.js";import{a as K}from"./chunk-YAVCKOY5.js";import{a as J}from"./chunk-7BH45QR6.js";import{c as E,e as O,f as j,j as H,k as G,l as B,m as $,n as q,o as L,p as R,q as Y,r as z}from"./chunk-6SI6O3BZ.js";import"./chunk-5LHHFRH4.js";import{j as A}from"./chunk-FTR46PKS.js";import{$b as _,Cb as c,Fa as D,Fb as w,Gb as T,Hb as o,Ib as n,Jb as y,Kb as I,Ob as u,Pb as d,Za as i,Zb as p,_b as C,cb as h,fc as k,gc as V,ib as v,ka as P,nb as f,r as M,ua as S,va as g,wa as b,yb as l}from"./chunk-LZBM4COA.js";var ee=(a,t)=>t.value;function te(a,t){if(a&1&&(o(0,"option",4),p(1),n()),a&2){let e=t.$implicit;l("value",e.value),i(),C(e.label)}}function ae(a,t){if(a&1&&(o(0,"p",5),p(1),n()),a&2){let e=d();i(),C(e.getFieldError("type"))}}function ie(a,t){if(a&1&&(o(0,"div",7),y(1,"app-form-field",10),o(2,"div",11),y(3,"app-form-field",12)(4,"app-form-field",13),n()()),a&2){let e=d();i(),l("errorMessage",e.getFieldError("cardNumber")),i(2),l("errorMessage",e.getFieldError("cardHolderName")),i(),l("errorMessage",e.getFieldError("expiryDate"))}}function ne(a,t){if(a&1&&(o(0,"div",8),y(1,"app-form-field",14),n()),a&2){let e=d();i(),l("errorMessage",e.getFieldError("paypalEmail"))}}function oe(a,t){if(a&1&&(o(0,"div",8),y(1,"app-form-field",15)(2,"app-form-field",16),n()),a&2){let e=d();i(),l("errorMessage",e.getFieldError("accountNumber")),i(),l("errorMessage",e.getFieldError("bankName"))}}function re(a,t){if(a&1&&(o(0,"div",8),y(1,"app-form-field",17),n()),a&2){let e=d();i(),l("required",!1)("errorMessage",e.getFieldError("cashDetails"))}}var x=class a{constructor(t){this.fb=t;this.paymentForm=this.createForm()}payment=null;isEditMode=!1;paymentSaved=new D;paymentTypes=[{value:"credit_card",label:"Tarjeta de Cr\xE9dito"},{value:"debit_card",label:"Tarjeta de D\xE9bito"},{value:"paypal",label:"PayPal"},{value:"bank_transfer",label:"Transferencia Bancaria"},{value:"cash_on_delivery",label:"Pago Contra Entrega"}];paymentForm;formErrorService=P(K);ngOnChanges(t){t.payment&&(this.payment?(this.populateForm(),this.paymentForm.get("type")?.disable()):(this.paymentForm.reset(),this.paymentForm.patchValue({type:""}),this.paymentForm.get("type")?.enable()))}createForm(){return this.fb.group({type:["",[E.required]],cardNumber:[""],cardHolderName:[""],expiryDate:[""],paypalEmail:["",[E.email]],bankName:[""],accountNumber:[""],cashDetails:[""]})}populateForm(){this.payment&&this.paymentForm.patchValue({type:this.payment.type||"",cardNumber:this.payment.cardNumber||"",cardHolderName:this.payment.cardHolderName||"",expiryDate:this.payment.expiryDate||"",paypalEmail:this.payment.paypalEmail||"",bankAccount:this.payment.bankName||""})}getFieldError(t){let e={type:"Tipo de pago",cardNumber:"N\xFAmero de tarjeta",cardHolderName:"Titular de la tarjeta",expiryDate:"Fecha de expiraci\xF3n",paypalEmail:"Email de PayPal",bankAccount:"Cuenta bancaria"};return this.formErrorService.getFieldError(this.paymentForm,t,e)}onSubmit(){if(this.paymentForm.invalid)return;let t=this.paymentForm.value;console.log(t);let e={_id:this.payment?._id??"",type:t.type,cardNumber:t.cardNumber||"",cardHolderName:t.cardHolderName||"",expiryDate:t.expiryDate||"",paypalEmail:t.paypalEmail||"",bankName:t.bankName||"",accountNumber:t.accountNumber||"",isDefault:this.payment?.isDefault??!1,isActive:this.payment?this.payment.isActive:!0};this.paymentForm.reset(),this.paymentSaved.emit(e)}static \u0275fac=function(e){return new(e||a)(h(Y))};static \u0275cmp=v({type:a,selectors:[["app-payment-form"]],inputs:{payment:"payment",isEditMode:"isEditMode"},outputs:{paymentSaved:"paymentSaved"},features:[S],decls:17,vars:8,consts:[[1,"space-y-6",3,"ngSubmit","formGroup"],[1,"block","text-sm","font-medium","text-gray-700","mb-3"],["formControlName","type",1,"w-full","p-2.5","bg-white","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-blue-500","focus:border-blue-500","block","disabled:bg-gray-100","disabled:cursor-not-allowed"],["value","","disabled",""],[3,"value"],[1,"mt-1","text-sm","text-red-600"],[1,"space-y-4","text-gray-700"],[1,"space-y-4","animate-fade-in"],[1,"animate-fade-in"],["type","submit",1,"w-full","flex","justify-center","py-2.5","px-4","border","border-transparent","rounded-lg","shadow-sm","text-sm","font-medium","text-white","bg-blue-600","hover:bg-green-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","disabled:opacity-50","disabled:cursor-not-allowed","transition-all","duration-200",3,"disabled"],["label","N\xFAmero de tarjeta","fieldId","cardNumber","type","text","placeholder","0000 0000 0000 0000","formControlName","cardNumber",3,"errorMessage"],[1,"grid","grid-cols-2","gap-4"],["label","Titular","fieldId","cardHolderName","type","text","placeholder","Nombre","formControlName","cardHolderName",3,"errorMessage"],["label","Vencimiento","fieldId","expiryDate","type","text","placeholder","MM/YY","formControlName","expiryDate",3,"errorMessage"],["label","Correo de PayPal","fieldId","paypalEmail","type","email","placeholder","correo@paypal.com","formControlName","paypalEmail",3,"errorMessage"],["label","Numero de cuenta","fieldId","accountNumber","type","text","placeholder","Numero de cuenta","formControlName","accountNumber",3,"errorMessage"],["label","Nombre del Banco","fieldId","bankName","type","text","placeholder","Nombre del banco","formControlName","bankName",3,"errorMessage"],["label","Detalles adicionales","fieldId","cashDetails","type","text","placeholder","Instrucciones (opcional)","formControlName","cashDetails",3,"required","errorMessage"]],template:function(e,r){if(e&1&&(o(0,"form",0),u("ngSubmit",function(){return r.onSubmit()}),o(1,"div")(2,"label",1),p(3,"Tipo de pago"),n(),o(4,"select",2)(5,"option",3),p(6,"Seleccione un tipo"),n(),w(7,te,2,2,"option",4,ee),n(),f(9,ae,2,1,"p",5),n(),o(10,"div",6),f(11,ie,5,3,"div",7)(12,ne,2,1,"div",8)(13,oe,3,2,"div",8)(14,re,2,2,"div",8),n(),o(15,"button",9),p(16),n()()),e&2){let m,s,N,F;l("formGroup",r.paymentForm),i(7),T(r.paymentTypes),i(2),c(r.getFieldError("type")?9:-1),i(2),c(((m=r.paymentForm.get("type"))==null?null:m.value)==="credit_card"||((m=r.paymentForm.get("type"))==null?null:m.value)==="debit_card"?11:-1),i(),c(((s=r.paymentForm.get("type"))==null?null:s.value)==="paypal"?12:-1),i(),c(((N=r.paymentForm.get("type"))==null?null:N.value)==="bank_transfer"?13:-1),i(),c(((F=r.paymentForm.get("type"))==null?null:F.value)==="cash_on_delivery"?14:-1),i(),l("disabled",r.paymentForm.invalid),i(),_(" ",r.isEditMode?"Actualizar M\xE9todo":"Guardar M\xE9todo"," ")}},dependencies:[z,H,q,L,$,O,j,R,G,B,J],encapsulation:2})};function me(a,t){if(a&1){let e=I();o(0,"div",5)(1,"div",6)(2,"app-payment-methods-list",7),u("edit",function(m){g(e);let s=d();return b(s.onEdit(m))})("delete",function(m){g(e);let s=d();return b(s.onDelete(m))}),n()(),o(3,"div",8)(4,"div",9)(5,"h2",10),p(6),n(),o(7,"app-payment-form",11),u("paymentSaved",function(m){g(e);let s=d();return b(s.onPaymentSaved(m))}),n()()()()}if(a&2){let e=d();i(2),l("paymentMethods",t)("isEditable",!0),i(4),_(" ",e.isEditing?"Editar M\xE9todo de Pago":"Nuevo M\xE9todo de Pago"," "),i(),l("payment",e.selectedPaymentMethod)("isEditMode",e.isEditing)}}var W=class a{constructor(t){this.paymentService=t}paymentMethods$=M([]);selectedPaymentMethod=null;isEditing=!1;ngOnInit(){this.paymentMethods$=this.paymentService.paymetMethods$}onEdit(t){this.selectedPaymentMethod=t,this.isEditing=!0}onDelete(t){confirm("\xBFEst\xE1s seguro de eliminar este m\xE9todo de pago?")&&this.paymentService.deletePaymentMethod(t).subscribe()}onAddNew(){this.selectedPaymentMethod=null,this.isEditing=!1}onPaymentSaved(t){this.isEditing?this.paymentService.editPaymentMethod(t).subscribe(()=>{this.onAddNew()}):this.paymentService.addPaymentMethod(t).subscribe(()=>{this.onAddNew()})}static \u0275fac=function(e){return new(e||a)(h(U))};static \u0275cmp=v({type:a,selectors:[["app-paymethods"]],decls:10,vars:3,consts:[[1,"container","mx-auto","px-4","py-8"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-gray-800"],[1,"bg-green-500","hover:bg-green-600","text-white","font-medium","py-2","px-4","rounded","transition-colors","duration-200","flex","items-center","gap-2",3,"click"],[1,"text-xl"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-8"],[1,"lg:col-span-2"],[3,"edit","delete","paymentMethods","isEditable"],[1,"lg:col-span-1"],[1,"bg-white","rounded-lg","shadow-md","p-6","sticky","top-4"],[1,"text-xl","font-semibold","mb-4","text-gray-800"],[3,"paymentSaved","payment","isEditMode"]],template:function(e,r){if(e&1&&(o(0,"div",0)(1,"div",1)(2,"h1",2),p(3,"M\xE9todos de Pago"),n(),o(4,"button",3),u("click",function(){return r.onAddNew()}),o(5,"span",4),p(6,"+"),n(),p(7," Agregar Nuevo "),n()(),f(8,me,8,5,"div",5),k(9,"async"),n()),e&2){let m;i(8),c((m=V(9,1,r.paymentMethods$))?8:-1,m)}},dependencies:[Q,x,A],encapsulation:2})};export{W as PaymethodsComponent};
