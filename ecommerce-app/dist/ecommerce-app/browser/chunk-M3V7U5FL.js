import{e as z}from"./chunk-S6GGOMMJ.js";import{a as U}from"./chunk-7BH45QR6.js";import{b as P,c as l,e as D,f as j,j as G,k as B,l as L,p as H,q as Y,r as O}from"./chunk-6SI6O3BZ.js";import{f as T}from"./chunk-5LHHFRH4.js";import"./chunk-FTR46PKS.js";import{Cb as k,Db as A,E,Fb as q,G as S,Gb as R,Gc as M,Hb as i,Ib as a,Jb as s,Ob as w,Pb as C,Xa as N,Z as I,Za as u,Zb as n,cb as y,ea as _,ib as g,ka as f,nb as V,r as p,v as F,xa as v,ya as x,yb as c}from"./chunk-LZBM4COA.js";var h=class r{baseUrl="http://localhost:3000/api";httpClient=f(M);checkEmailExist(t){return this.httpClient.get(`${this.baseUrl}/auth/check-email`,{params:{email:t}}).pipe(F(e=>e.exists))}static \u0275fac=function(e){return new(e||r)};static \u0275prov=_({token:r,factory:r.\u0275fac,providedIn:"root"})};function W(r,t){if(r&1&&s(0,"app-form-field",7),r&2){let e=t.$implicit,o=C();c("label",e.label)("fieldId",e.fieldId)("type",e.type)("placeholder",e.placeholder)("required",e.required)("errorMessage",o.getErrorMessage(e.fieldId))("formControlName",e.fieldId)}}function X(r,t){if(r&1&&(s(0,"img",20),i(1,"p",21),n(2," Clic para cambiar imagen "),a()),r&2){let e=C();c("src",e.imagePreview,N)}}function Z(r,t){r&1&&(i(0,"div",22),v(),i(1,"svg",23),s(2,"path",16),a()(),x(),i(3,"p",21),n(4," Agregar foto de perfil "),a(),i(5,"p",24),n(6,"PNG, JPG hasta 5MB"),a())}var b=class r{constructor(t,e){this.authService=t;this.store=e;this.registerForm=this.fb.group({displayName:["",[l.required]],email:["",[l.email,l.required],[this.emailAsycValidator()]],phone:["",[l.required,this.phoneValidator()]],dateOfBirth:["",[l.required]],avatar:[""],password:["",[l.required]],repeatPassword:["",[l.required]]},{validators:this.matchPasswordValidator("password","repeatPassword")})}imagePreview="";fb=f(Y);registerForm;fields=[{label:"Nombre de usuario",fieldId:"displayName",type:"text",placeholder:"Nick Name",required:!0},{label:"fecha de nacimiento",fieldId:"dateOfBirth",type:"date",placeholder:"DD/MM/YYYY",required:!0},{label:"email",fieldId:"email",type:"email",placeholder:"TuCorreoElectr\xF3nico@example.com",required:!0},{label:"telefono",fieldId:"phone",type:"text",placeholder:"10 digitos",required:!0},{label:"contrase\xF1a",fieldId:"password",type:"password",placeholder:"*******",required:!0},{label:"repetir contrase\xF1a",fieldId:"repeatPassword",type:"password",placeholder:"*******",required:!0}];onImageSelect(t){let e=t.target,o=e.files&&e.files.length>0?e.files[0]:null;if(o){let m=new FileReader;m.onload=d=>{this.imagePreview=d.target?.result},m.readAsDataURL(o)}}matchPasswordValidator(t,e){return o=>{let m=o.get(t)?.value,d=o.get(e)?.value;return m===d?null:{doesnt_match:!0}}}phoneValidator(){return t=>{let e=t.value;return console.log(e.length),console.log(Number.isNaN(+e)),e.length!==10||Number.isNaN(+e)?{invalid_phone:!0}:null}}emailAsycValidator(){return t=>t.value?(console.log(t.value),this.authService.checkEmailExist(t.value).pipe(S(500),I(e=>e?p({emailTaken:!0}):p(null)),E(()=>p({cantFetch:!0})))):p(null)}getErrorMessage(t){let e=this.registerForm.get(t);return!e||!e.touched?"":e.hasError("required")?"Este campo es requerido":e.hasError("email")?"Email no valido":e.hasError("emailTaken")?"Este usuario ya existe":e.hasError("cantFetch")?"Error del servidor, intente en otro momento":e.hasError("invalid_phone")?"Telefono no valido":(t==="password"||t==="repeatPassword")&&this.registerForm.hasError("doesnt_match")?"Las contrase\xF1as deben ser iguales":""}handleSubmit(){console.log(this.registerForm.value),this.store.dispatch(z({userData:this.registerForm.value}))}static \u0275fac=function(e){return new(e||r)(y(h),y(T))};static \u0275cmp=g({type:r,selectors:[["app-register-form"]],decls:29,vars:3,consts:[[1,"min-h-screen","bg-gradient-to-br","from-gray-50","via-white","to-blue-50/40","flex","items-center","justify-center","py-12","px-4","sm:px-6","lg:px-8"],[1,"max-w-md","w-full","space-y-8"],[1,"bg-white/90","backdrop-blur-md","p-8","rounded-2xl","shadow-xl","border","border-gray-200/40","space-y-6","transition-all","duration-300",3,"ngSubmit","formGroup"],[1,"text-center"],[1,"text-3xl","font-extrabold","text-gray-900","tracking-tight"],[1,"mt-2","text-sm","text-gray-600"],[1,"space-y-5"],[3,"label","fieldId","type","placeholder","required","errorMessage","formControlName"],[1,"pt-2"],[1,"block","text-sm","font-medium","text-gray-700","mb-3"],[1,"relative","cursor-pointer","group"],["formControlName","avatar","type","file","accept","image/*",1,"absolute","inset-0","w-full","h-full","opacity-0","cursor-pointer","z-10",3,"change"],[1,"border-2","border-dashed","border-gray-200","rounded-xl","p-8","text-center","bg-white/60","backdrop-blur-sm","group-hover:border-blue-400","group-hover:bg-blue-50/70","transition-all","duration-200","shadow-sm"],["type","submit",1,"w-full","py-3.5","px-6","rounded-xl","font-semibold","text-base","bg-gradient-to-r","from-blue-600","to-blue-700","hover:from-blue-700","hover:to-blue-800","text-white","shadow-lg","hover:shadow-xl","transform","hover:scale-[1.02]","active:scale-[0.98]","transition-all","duration-300","disabled:bg-gray-200","disabled:text-gray-400","disabled:cursor-not-allowed","disabled:shadow-none",3,"disabled"],[1,"flex","items-center","justify-center","gap-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],[1,"text-center","pt-4"],[1,"text-sm","text-gray-500"],["routerLink","/login",1,"font-medium","text-blue-600","hover:text-blue-700","hover:underline","transition-colors","duration-200"],["alt","preview",1,"w-24","h-24","object-cover","rounded-full","mx-auto","mb-3","border-4","border-white","shadow-md",3,"src"],[1,"text-sm","font-medium","text-gray-700"],[1,"w-16","h-16","mx-auto","mb-3","bg-gray-100","rounded-full","flex","items-center","justify-center","shadow-sm"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-gray-400"],[1,"text-xs","text-gray-500","mt-1"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div",1)(2,"form",2),w("ngSubmit",function(){return o.handleSubmit()}),i(3,"div",3)(4,"h2",4),n(5," Crear cuenta "),a(),i(6,"p",5),n(7,"\xDAnete a nuestra comunidad"),a()(),i(8,"div",6),q(9,W,1,7,"app-form-field",7,A),a(),i(11,"div",8)(12,"label",9),n(13," Foto de perfil (opcional) "),a(),i(14,"div",10)(15,"input",11),w("change",function(d){return o.onImageSelect(d)}),a(),i(16,"div",12),V(17,X,3,1)(18,Z,7,0),a()()(),i(19,"button",13)(20,"span",14),v(),i(21,"svg",15),s(22,"path",16),a(),n(23," Crear cuenta "),a()(),x(),i(24,"div",17)(25,"p",18),n(26," \xBFYa tienes cuenta? "),i(27,"a",19),n(28," Inicia sesi\xF3n "),a()()()()()()),e&2&&(u(2),c("formGroup",o.registerForm),u(7),R(o.fields),u(8),k(o.imagePreview?17:18),u(2),c("disabled",!o.registerForm.valid))},dependencies:[O,G,P,D,j,H,B,L,U],encapsulation:2})};var J=class r{static \u0275fac=function(e){return new(e||r)};static \u0275cmp=g({type:r,selectors:[["app-register"]],decls:1,vars:0,template:function(e,o){e&1&&s(0,"app-register-form")},dependencies:[b],encapsulation:2})};export{J as RegisterComponent};
